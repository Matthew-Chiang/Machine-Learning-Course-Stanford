if (self.CavalryLogger) { CavalryLogger.start_js(["BVuFM"]); }

__d('MessengerPhotoishXMA.react',['BootloadedComponent.react','JSResource','React','requireWeak'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=void 0;c('requireWeak')('MessengerPhotosGroup.react',function(l){j=l;});h=babelHelpers.inherits(k,c('React').Component);i=h&&h.prototype;function k(l){i.constructor.call(this,l);}k.prototype.shouldComponentUpdate=function(l,m){return this.props!==l;};k.prototype.render=function(){if(!j)return c('React').createElement(c('BootloadedComponent.react'),babelHelpers['extends']({bootloadPlaceholder:c('React').createElement('div',null),bootloadLoader:c('JSResource')('MessengerPhotosGroup.react').__setRef('MessengerPhotoishXMA.react'),isXMA:true},this.props));return c('React').createElement(j,babelHelpers['extends']({isXMA:true},this.props));};f.exports=k;}),null);
__d('MercurySharePreview.react',['cx','invariant','AsyncRequest','LeftRight.react','MercuryFallbackShareAttachment.react','MercuryShareAttachmentRenderLocations','React','XUICloseButton.react','XUISpinner.react','setImmediate'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l=c('React').PropTypes;j=babelHelpers.inherits(m,c('React').Component);k=j&&j.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=k.constructor).call.apply(n,[this].concat(q)),this.$MercurySharePreview1=1337,this.$MercurySharePreview2=null,this.state={attachmentData:null,loading:false},this.$MercurySharePreview11=function(){this.$MercurySharePreview5();this.props.onClose&&this.props.onClose(this.props.threadID);}.bind(this),o;}m.prototype.componentWillMount=function(){this.$MercurySharePreview3(this.props.share);this.$MercurySharePreview4(this.props.uri);};m.prototype.componentWillUnmount=function(){this.$MercurySharePreview5();};m.prototype.componentWillReceiveProps=function(n){!(n.share&&n.uri)||i(0);if(!n.share&&!n.uri)this.$MercurySharePreview5();this.$MercurySharePreview3(n.share);this.$MercurySharePreview4(n.uri);};m.prototype.$MercurySharePreview3=function(n){var o=this.state.attachmentData||this.state.loading;if(n&&!o)this.$MercurySharePreview6(n);};m.prototype.$MercurySharePreview4=function(n){var o=this.state.attachmentData||this.state.loading;if(n&&!(o&&this.props.uri===n))this.$MercurySharePreview7(n);};m.prototype.componentDidUpdate=function(n,o){this.props.onUpdate&&this.props.onUpdate(this);};m.prototype.getShareData=function(){return this.state.attachmentData&&this.state.attachmentData.share_data;};m.prototype.isLoading=function(){return this.state.loading;};m.prototype.$MercurySharePreview6=function(n){this.$MercurySharePreview2=new (c('AsyncRequest'))().setURI('/message_share_attachment/fromParams/').setData({image_height:this.props.imageSize.height,image_width:this.props.imageSize.width,share_params:n.params,share_type:n.type}).setHandler(this.$MercurySharePreview8.bind(this,this.$MercurySharePreview9()));c('setImmediate')(function(){this.props.onLoading&&this.props.onLoading(this.props.threadID);}.bind(this));this.$MercurySharePreview2&&this.$MercurySharePreview2.send();this.setState({loading:true,attachmentData:null});};m.prototype.$MercurySharePreview7=function(n){this.$MercurySharePreview2=new (c('AsyncRequest'))().setURI('/message_share_attachment/fromURI/').setData({image_height:this.props.imageSize.height,image_width:this.props.imageSize.width,uri:n}).setHandler(this.$MercurySharePreview8.bind(this,this.$MercurySharePreview9()));c('setImmediate')(function(){this.props.onLoading&&this.props.onLoading(this.props.threadID);}.bind(this));this.$MercurySharePreview2&&this.$MercurySharePreview2.send();this.setState({loading:true,attachmentData:null});};m.prototype.$MercurySharePreview9=function(){return ++this.$MercurySharePreview1;};m.prototype.$MercurySharePreview10=function(){return this.$MercurySharePreview1;};m.prototype.$MercurySharePreview8=function(n,o){if(this.$MercurySharePreview10()!==n)return;var p=o.payload;if(p){this.props.onLoaded&&this.props.onLoaded(this.props.threadID,p);this.setState({loading:false,attachmentData:p});}else this.props.onClose&&this.props.onClose(this.props.threadID);};m.prototype.$MercurySharePreview5=function(){this.$MercurySharePreview9();this.$MercurySharePreview2&&this.$MercurySharePreview2.abort();this.$MercurySharePreview2=null;this.setState({loading:false,attachmentData:null});};m.prototype.render=function(){var n="_tig"+(' '+"_tih");if(this.state.loading)return c('React').createElement(c('LeftRight.react'),{direction:c('LeftRight.react').DIRECTION.right,className:n},c('React').createElement(c('XUISpinner.react'),{className:"_tii",size:'large',background:'light'}),c('React').createElement(c('XUICloseButton.react'),{className:"_tij",shade:'dark',size:'small',onClick:this.$MercurySharePreview11}));var o=this.state.attachmentData;if(!o)return c('React').createElement('div',null);return c('React').createElement('div',null,c('React').createElement(c('MercuryFallbackShareAttachment.react'),{attachment:o,location:c('MercuryShareAttachmentRenderLocations').CHAT_PREVIEW}),c('React').createElement(c('XUICloseButton.react'),{className:"_tij",shade:'dark',size:'small',onClick:this.$MercurySharePreview11}));};m.propTypes={threadID:l.string,imageSize:l.shape({width:l.number.isRequired,height:l.number.isRequired}).isRequired,location:l.oneOf(c('MercuryShareAttachmentRenderLocations').getValues()).isRequired,share:l.shape({params:l.array,type:l.number}),uri:l.string,onClose:l.func,onLoaded:l.func,onLoading:l.func,onUpdate:l.func};f.exports=m;}),null);
__d('MessengerLightweightActionAttachment.react',['cx','fbt','MercuryMessageActions','MercuryConfig','MercuryFallbackShareAttachment.react','MercuryShareAttachmentRenderLocations','MercurySourceType','MercuryMessageObject','CurrentUser','Link.react','React'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l=c('MercuryMessageActions').get(),m=c('CurrentUser').getID();j=babelHelpers.inherits(n,c('MercuryFallbackShareAttachment.react'));k=j&&j.prototype;function n(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=k.constructor).call.apply(o,[this].concat(r)),this.$MessengerLightweightActionAttachment1=function(event){var t=c('MercuryMessageObject').getForFBID(m).constructAttachmentMessageObject(c('MercurySourceType').MESSENGER_WEB,this.props.threadID);t.lightweight_action_attachment={lwa_state:'RECIPROCATED',lwa_type:this.props.attachment.target.lwa_type};l.send(t);this.props.onCompletion&&this.props.onCompletion();}.bind(this),p;}n.prototype.renderLink=function(o){if(c('MercuryShareAttachmentRenderLocations').isPreview(this.props.location)||this.props.attachment.target.lwa_state!='INITIATED')return c('MercuryConfig').NewWave?c('React').createElement('div',{className:"_18oz"},o):o;return c('MercuryConfig').NewWave?c('React').createElement('div',{className:"_18oz _18o_"},o,c('React').createElement('div',{className:"_18p0"},c('React').createElement(c('Link.react'),{className:"_5rw4 _18p1",onClick:this.$MessengerLightweightActionAttachment1,target:'_blank',tabIndex:'0'},i._("Wave"),this.renderLayers()))):c('React').createElement(c('Link.react'),{className:"_5rw4",onClick:this.$MessengerLightweightActionAttachment1,target:'_blank',tabIndex:'0'},o,this.renderLayers());};f.exports=n;}),null);
__d('MercuryShareSizeImageByWidthMixin',['Image.react','MercuryAttachment','MercuryShareAttachmentRenderLocations','MercuryShareImage.react','React'],(function a(b,c,d,e,f,g){var h={_getImageSize:function i(j){var k=this.props.attachment&&this.props.attachment.media,l=j&&k&&k.animated_image?k&&k.animated_image_size:k&&k.image_size;return this.props.maxWidth?c('MercuryAttachment').resizeContain({height:this.props.maxWidth,width:this.props.maxWidth},l):l;},_renderImage:function i(j){var k=this.props.attachment&&this.props.attachment.media,l=this._getImageSize(j),m=j&&k&&k.animated_image?k.animated_image:k&&k.image;if(this.props.location==c('MercuryShareAttachmentRenderLocations').CHAT){return c('React').createElement(c('MercuryShareImage.react'),{height:l&&l.height,source:m,width:l&&l.width});}else return c('React').createElement(c('Image.react'),{height:l&&l.height,src:m,width:l&&l.width});}};f.exports=h;}),null);
__d('MercuryVideoShareXMATextBlock.react',['cx','React','ShimButton.react','joinClasses'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes,l=4;i=babelHelpers.inherits(m,c('React').Component);j=i&&i.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=j.constructor).call.apply(n,[this].concat(q)),this.$MercuryVideoShareXMATextBlock1=function(){this.props.url&&window.open(this.props.url);}.bind(this),o;}m.prototype.render=function(){if(!this.props)return c('React').createElement('div',{className:"__6j"});var n=this.props.width?{maxWidth:this.props.width-l}:{},o={textDecoration:'none'};return c('React').createElement('div',{className:c('joinClasses')(this.props.className,"__6j _43kk"),style:n},c('React').createElement(c('ShimButton.react'),{form:'link',onClick:this.$MercuryVideoShareXMATextBlock1,style:o},this.renderTitle(),this.renderDescription(),this.renderSource()));};m.prototype.renderTitle=function(){if(!this.props.title)return null;return c('React').createElement('div',{className:"__6k"+(!this.props.uri&&!this.props.description?' '+"_2xsq":'')},this.props.title);};m.prototype.renderDescription=function(){if(!this.props.description)return null;return c('React').createElement('div',{className:"__6l"},this.props.description);};m.prototype.renderSource=function(){if(!this.props.source)return null;return c('React').createElement('div',{className:"__6m"},this.props.source);};m.propTypes={className:k.string,description:k.string,source:k.string,title:k.string,url:k.string,width:k.number};f.exports=m;}),null);
__d('MercuryVideoShareXMA.react',['cx','MessengerVideoPlayer.react','MercuryVideoShareXMATextBlock.react','React','joinClasses'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes,l=181,m=200;i=babelHelpers.inherits(n,c('React').PureComponent);j=i&&i.prototype;n.prototype.render=function(){var o=this.$MercuryVideoShareXMA1(this.props.attachment),p=this.$MercuryVideoShareXMA2(o);return c('React').createElement('div',{className:"_3duc"},p,this.$MercuryVideoShareXMA3(o&&o.original_dimensions));};n.prototype.$MercuryVideoShareXMA2=function(o){return o?c('React').createElement(c('MessengerVideoPlayer.react'),{attachment:this.props.attachment,videoData:o,isInThread:true,isVisible:this.props.isVisible,className:c('joinClasses')(this.props.className,"_n4o"+(' '+"_3_om")+(' '+"_1wno"))}):null;};n.prototype.$MercuryVideoShareXMA1=function(o){if(!o.media||!o.media.image_size||!o.target||!o.target.video_id)return null;var p=o.media.image_size;return {legacy_attachment_id:o.target.video_id,original_dimensions:this.$MercuryVideoShareXMA4(p),start_muted:true,no_fullscreen:true,hide_controls_on_finish:true,url:o.media.image,is_share:true};};n.prototype.$MercuryVideoShareXMA4=function(o){if(o.width<=l&&o.height<=m)return {x:o.width,y:o.height};var p=Math.min(l/o.width,m/o.height),q=Math.ceil(o.width*p),r=Math.ceil(o.height*p);return {x:q,y:r};};n.prototype.$MercuryVideoShareXMA3=function(o){var p=this.props.attachment;return c('React').createElement(c('MercuryVideoShareXMATextBlock.react'),{description:p.description,source:p.source,title:p.video_title,url:p.uri,width:o&&o.x});};function n(){i.apply(this,arguments);}n.propTypes={attachment:k.object.isRequired,isVisible:k.bool,onClick:k.func};f.exports=n;}),null);
__d('MercuryVideoShareAttachment.react',['cx','ix','CenteredContainer.react','FBOverlayBase.react','FBOverlayContainer.react','FBOverlayElement.react','Image.react','Link.react','MercuryAttachmentType','MercuryFallbackShareAttachment.react','MercuryShareAttachmentReactShape','MercuryShareAttachmentRenderLocations','MercuryShareSizeImageByWidthMixin','MercuryVideoShareXMA.react','MessengerPhotoishXMA.react','React'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=c('React').PropTypes,k=c('React').createClass({displayName:'MercuryVideoShareAttachment',mixins:[c('MercuryShareSizeImageByWidthMixin')],propTypes:{attachment:c('MercuryShareAttachmentReactShape'),location:j.oneOf(c('MercuryShareAttachmentRenderLocations').getValues()),maxWidth:j.number},render:function l(){if(this.props.location===c('MercuryShareAttachmentRenderLocations').CHAT_PREVIEW){return c('React').createElement(c('MercuryFallbackShareAttachment.react'),this.props);}else if(this.props.location===c('MercuryShareAttachmentRenderLocations').MESSENGER){return c('React').createElement(c('MessengerPhotoishXMA.react'),{attachType:c('MercuryAttachmentType').VIDEO,attachments:[this.props.attachment],isVisible:!!this.props.isVisible,onSelect:this.props.onSelect});}else if(this.props.location===c('MercuryShareAttachmentRenderLocations').CHAT)return c('React').createElement(c('MercuryVideoShareXMA.react'),this.props);var m=this.props.attachment&&this.props.attachment.uri;return c('React').createElement(c('Link.react'),{rel:'theater',href:m},c('React').createElement(c('FBOverlayContainer.react'),{className:"clearfix",style:this._getImageSize()},c('React').createElement(c('FBOverlayBase.react'),null,this._renderImage()),c('React').createElement(c('FBOverlayElement.react'),null,c('React').createElement(c('CenteredContainer.react'),{vertical:true},c('React').createElement(c('Image.react'),{src:i("27983")})))));}});f.exports=k;}),null);
__d('MercuryYoutubeLinkParser',['MercuryShareAttachmentRenderLocations','URI'],(function a(b,c,d,e,f,g){'use strict';var h='www.youtube.com',i='m.youtube.com',j='youtu.be',k='https://www.youtube.com/',l='/watch',m={isValidYoutubeLink:function n(o,p){var q=this._getYoutubeURI(p),r=q.getDomain();return o===c('MercuryShareAttachmentRenderLocations').MESSENGER&&(r===h||r===i||r===j)&&this.getVideoID(q)!==null;},_getYoutubeURI:function n(o){var p=new (c('URI'))(o);if(this.isShareLink(p))return p;var q=p.getQueryData().u;return q?new (c('URI'))(q):p;},getVideoID:function n(o){var p=o.getPath();if(this.isShareLink(o))return p;if(p===l)return o.getQueryData().v;return null;},getVideoEmbedURI:function n(o,p){if(this.isValidYoutubeLink(o,p)){var q=this._getYoutubeURI(p),r=q.getQueryData().t,s=new (c('URI'))(k).setPath('/embed/'+this.getVideoID(q));if(r!=null){var t=this.shareLinkStartTimeToEmbedStartTime(r);if(t!=null)s.setQueryData({start:t});}return s.toString();}else return '';},isShareLink:function n(o){return o.getDomain()===j;},shareLinkStartTimeToEmbedStartTime:function n(o){var p=o.match(/((\d+)h)?((\d+)m)?((\d+)s)?/);if(p==null||p[0]==='')return null;var q=p[2],r=p[4],s=p[6];return Number(q||0)*3600+Number(r||0)*60+Number(s||0)+'';}};f.exports=m;}),null);
__d('MercuryVideoShareYoutubeAttachment.react',['cx','BootloadOnRender.react','JSResource','LazyComponent.react','MercuryFallbackShareAttachment.react','MercuryShareAttachmentRenderLocations','MercuryYoutubeLinkParser','React'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.$MercuryVideoShareYoutubeAttachment1=function(){var r={aspectRatio:9/16,height:0,lockHeight:false,width:0};return {chatImageDimensions:r,chatMediaDimensions:r,chatTextClasses:"_3rnp",mediaSrc:c('MercuryYoutubeLinkParser').getVideoEmbedURI(this.props.location,this.props.attachment.uri),messengerImageDimensions:r,messengerMediaDimensions:r,messengerTextClasses:"_3rnq",showMediaWithText:true};}.bind(this),n;}l.prototype.render=function(){if(c('MercuryYoutubeLinkParser').isValidYoutubeLink(this.props.location,this.props.attachment.uri))return c('React').createElement(c('BootloadOnRender.react'),{loader:c('JSResource')('MercuryThirdPartyMediaAttachmentContent.react').__setRef('MercuryVideoShareYoutubeAttachment.react'),component:c('React').createElement(c('LazyComponent.react'),{attachment:this.props.attachment,location:this.props.location,media:this.$MercuryVideoShareYoutubeAttachment1()}),placeholder:c('React').createElement('div',null)});return c('React').createElement(c('MercuryFallbackShareAttachment.react'),this.props);};l.propTypes={attachment:k.object.isRequired,location:k.oneOf(c('MercuryShareAttachmentRenderLocations').getValues()).isRequired,maxWidth:k.number};f.exports=l;}),null);